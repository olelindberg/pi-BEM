# Listing of Parameters
# ---------------------
subsection BEMFMA<3>
  subsection FMA Params
    set FMA Truncation Order                  = 6
    set Granularity for TBB simple for cycles = 10
  end

  subsection Octree Params
    set Maximum Number of Collocation Points per Childless Block = 20
    set Number of Octree Levels                                  = 10
  end

end


subsection BEMProblem<3>
  set Continuos gradient across edges = true
  set Mapping Q Degree                = 1
  set Mapping Type                    = FE
  set Preconditioner                  = ILU
  set Solution method                 = Direct


  subsection Grid Refinement
    set Coarsening threshold = 0.03
    set Refinement threshold = 0.3
  end

  subsection Quadrature rules
    set Quadrature order          = 4
    set Quadrature type           = gauss
    set Singular quadrature order = 9
  end

  subsection Scalar Finite Element
    set Finite Element type  = FEQ
    set Finite element order = 1
  end

  subsection Solver
    set Log frequency = 1
    set Log history   = false
    set Log result    = true
    set Max steps     = 100
    set Tolerance     = 1.e-10
  end

  subsection Vector Finite Element
    set Finite Element type  = FEQ
    set Finite element order = 1
  end

end


subsection BoundaryConditions<3>
  set Output file name = result

  subsection Potential 2d
    set Function constants  = 
    set Function expression = x+y
    set Variable names      = x,y,t
  end

  subsection Potential 3d
    set Function constants  = 
    set Function expression = x+y+z
    set Variable names      = x,y,z,t
  end

  subsection Wind function 2d
    set Function constants  = 
    set Function expression = 1; 1
    set Variable names      = x,y,t
  end

  subsection Wind function 3d
    set Function constants  = 
    set Function expression = 1; 1; 1
    set Variable names      = x,y,z,t
  end

end


subsection ComputationalDomain<3>
  set Axis x dimension                                                         = 2.
  set Axis y dimension                                                         = 3.
  set Axis z dimension                                                         = 4.
  set Cad tolerance to projectors tolerance ratio                              = 100
  set Cells per circle                                                         = 12
  set Input grid format                                                        = inp
  set Input grid name                                                          = ../../../grids/coarse_sphere
  set Input path to CAD files                                                  = ./
  set Max aspect ratio                                                         = 3.5
  set Maximum number of curvature adaptive refinement cycles                   = 2
  set Number of cycles                                                         = 4
  set Number of global refinement to be executed before local refinement cycle = 0
  set Surface curvature adaptive refinement                                    = false
  set Use a spheroid                                                           = false
  set Use iges surfaces and curves                                             = false


  subsection Boundary Conditions ID Numbers
    set Dirichlet boundary ids = 1,110,110
    set Neumann boundary ids   = 0,110,110
  end

end


subsection Driver<3>
  set Set Global Refinement = true
end


